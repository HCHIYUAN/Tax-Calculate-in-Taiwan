<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2025 ç¨…å‹™è©¦ç®—</title>
    
    <!-- === æ‰‹æ©Ÿ App å„ªåŒ–è¨­å®š (PWA) === -->
    <!-- 1. è¨­å®š App Icon (ä½¿ç”¨ SVG å…§åµŒï¼Œä¸éœ€é¡å¤–åœ–æª”) -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ’°</text></svg>">
    
    <!-- 2. iOS Safari è¨­å®š -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ç¨…å‹™è©¦ç®—">
    
    <!-- 3. Android Chrome è¨­å®š -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#2563eb">

    <!-- å¼•å…¥ Tailwind CSS (æ¨£å¼) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- å¼•å…¥ React å’Œ ReactDOM (æ ¸å¿ƒ) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- å¼•å…¥ Babel (è®“ç€è¦½å™¨çœ‹æ‡‚ JSX) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        /* ç°¡å–®çš„æ·¡å…¥å‹•ç•« */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn {
            animation: fadeIn 0.3s ease-out forwards;
        }
        /* é˜²æ­¢æ‰‹æ©Ÿç‰ˆæ©«å‘æº¢å‡º */
        body {
            overscroll-behavior-y: none;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 pb-10">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- åœ–æ¨™çµ„ä»¶ ---
        const IconCalculator = ({className}) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="16" height="20" x="4" y="2" rx="2"/><line x1="8" x2="16" y1="6" y2="6"/><line x1="16" x2="16" y1="14" y2="18"/><path d="M16 10h.01"/><path d="M12 10h.01"/><path d="M8 10h.01"/><path d="M12 14h.01"/><path d="M8 14h.01"/><path d="M12 18h.01"/><path d="M8 18h.01"/></svg>
        );
        const IconInfo = ({className}) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
        );
        const IconDollarSign = ({className}) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="12" x2="12" y1="2" y2="22"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
        );
        const IconUser = ({className}) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
        );
        const IconUsers = ({className}) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
        );
        const IconBaby = ({className}) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M9 12h.01"/><path d="M15 12h.01"/><path d="M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5"/><path d="M19 6.3a9 9 0 0 1 1.8 3.9 2 2 0 0 1 0 3.6 9 9 0 0 1-17.6 0 2 2 0 0 1 0-3.6A9 9 0 0 1 12 3c2 0 3.5 1.1 3.5 2.5s-.9 2.5-2 2.5c-.8 0-1.5-.4-1.5-1"/></svg>
        );
        const IconFileText = ({className}) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4h4"/><path d="M10 9H8"/><path d="M16 13H8"/><path d="M16 17H8"/></svg>
        );
        const IconCheckCircle = ({className}) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><path d="M22 4 12 14.01l-3-3"/></svg>
        );
        const IconChevronDown = ({className}) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m6 9 6 6 6-6"/></svg>
        );
        const IconChevronUp = ({className}) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m18 15-6-6-6 6"/></svg>
        );

        // --- ä¸»ç¨‹å¼é‚è¼¯ ---
        const TaxCalculator = () => {
          const CONSTANTS = {
            EXEMPTION_NORMAL: 97000,
            EXEMPTION_ELDER: 145500,
            STD_DEDUCTION_SINGLE: 131000,
            STD_DEDUCTION_MARRIED: 262000,
            SALARY_DEDUCTION_CAP: 218000,
            PRESCHOOL_DEDUCTION: 120000,
          };

          const [inputs, setInputs] = useState({
            salary: 1000000,
            otherIncome: 0,
            isMarried: false,
            spouseIncome: 0,
            dependentsUnder70: 0,
            dependentsOver70: 0,
            childrenUnder6: 0,
            deductionMode: 'auto',
            itemizedAmount: 0,
          });

          const [results, setResults] = useState({
            totalIncome: 0,
            totalExemption: 0,
            salaryDeduction: 0,
            stdDeductionValue: 0,
            finalDeduction: 0,
            preschoolDeduction: 0,
            netIncome: 0,
            taxRate: 0,
            progressiveDifference: 0,
            taxPayable: 0,
            effectiveRate: 0,
            deductionTypeUsed: 'æ¨™æº–æ‰£é™¤é¡'
          });

          const [showDetails, setShowDetails] = useState(false);

          const handleInputChange = (field, value) => {
            let parsedValue = value === '' ? 0 : parseInt(value, 10);
            if (isNaN(parsedValue)) parsedValue = 0;
            if (field !== 'isMarried' && field !== 'deductionMode' && parsedValue < 0) parsedValue = 0;

            setInputs(prev => ({
              ...prev,
              [field]: field === 'isMarried' || field === 'deductionMode' ? value : parsedValue
            }));
          };

          useEffect(() => {
            const {
              salary, otherIncome, isMarried, spouseIncome,
              dependentsUnder70, dependentsOver70, childrenUnder6,
              deductionMode, itemizedAmount
            } = inputs;

            const totalIncome = salary + otherIncome + (isMarried ? spouseIncome : 0);

            const selfExemption = CONSTANTS.EXEMPTION_NORMAL;
            const spouseExemption = isMarried ? CONSTANTS.EXEMPTION_NORMAL : 0;
            const depUnder70Exemption = dependentsUnder70 * CONSTANTS.EXEMPTION_NORMAL;
            const depOver70Exemption = dependentsOver70 * CONSTANTS.EXEMPTION_ELDER;
            const totalExemption = selfExemption + spouseExemption + depUnder70Exemption + depOver70Exemption;

            const selfSalaryDed = Math.min(salary, CONSTANTS.SALARY_DEDUCTION_CAP);
            const spouseSalaryDed = isMarried ? Math.min(spouseIncome, CONSTANTS.SALARY_DEDUCTION_CAP) : 0;
            const totalSalaryDeduction = selfSalaryDed + spouseSalaryDed;

            const totalPreschoolDeduction = childrenUnder6 * CONSTANTS.PRESCHOOL_DEDUCTION;

            const standardDeductionValue = isMarried ? CONSTANTS.STD_DEDUCTION_MARRIED : CONSTANTS.STD_DEDUCTION_SINGLE;
            
            let finalGeneralDeduction = 0;
            let deductionTypeUsed = 'æ¨™æº–æ‰£é™¤é¡';

            if (deductionMode === 'itemized') {
              finalGeneralDeduction = itemizedAmount;
              deductionTypeUsed = 'åˆ—èˆ‰æ‰£é™¤é¡';
            } else if (deductionMode === 'standard') {
              finalGeneralDeduction = standardDeductionValue;
            } else {
              if (itemizedAmount > standardDeductionValue) {
                finalGeneralDeduction = itemizedAmount;
                deductionTypeUsed = 'åˆ—èˆ‰æ‰£é™¤é¡ (ç³»çµ±è‡ªå‹•å„ªåŒ–)';
              } else {
                finalGeneralDeduction = standardDeductionValue;
                deductionTypeUsed = 'æ¨™æº–æ‰£é™¤é¡ (ç³»çµ±è‡ªå‹•å„ªåŒ–)';
              }
            }

            let net = totalIncome - totalExemption - finalGeneralDeduction - totalSalaryDeduction - totalPreschoolDeduction;
            if (net < 0) net = 0;

            let tax = 0;
            let rate = 5;
            let diff = 0;

            if (net <= 590000) {
              rate = 5;
              diff = 0;
              tax = net * 0.05;
            } else if (net <= 1330000) {
              rate = 12;
              diff = 41300;
              tax = net * 0.12 - 41300;
            } else if (net <= 2660000) {
              rate = 20;
              diff = 147700;
              tax = net * 0.20 - 147700;
            } else if (net <= 4980000) {
              rate = 30;
              diff = 413700;
              tax = net * 0.30 - 413700;
            } else {
              rate = 40;
              diff = 911700;
              tax = net * 0.40 - 911700;
            }

            if (tax < 0) tax = 0;

            setResults({
              totalIncome,
              totalExemption,
              salaryDeduction: totalSalaryDeduction,
              stdDeductionValue: standardDeductionValue,
              finalDeduction: finalGeneralDeduction,
              preschoolDeduction: totalPreschoolDeduction,
              netIncome: net,
              taxRate: rate,
              progressiveDifference: diff,
              taxPayable: Math.round(tax),
              effectiveRate: totalIncome > 0 ? (tax / totalIncome * 100).toFixed(2) : 0,
              deductionTypeUsed
            });

          }, [inputs]);

          const formatCurrency = (num) => {
            return new Intl.NumberFormat('zh-TW', { style: 'currency', currency: 'TWD', maximumFractionDigits: 0 }).format(num);
          };

          return (
            <div className="min-h-screen bg-slate-50 p-4 md:p-8 font-sans text-slate-800 pb-20 safe-area-inset-bottom">
              <div className="max-w-5xl mx-auto space-y-6">
                
                {/* Header - æ‰‹æ©Ÿå„ªåŒ–ç‰ˆ */}
                <header className="text-center space-y-2 mb-8 pt-4">
                  <div className="inline-flex items-center justify-center p-3 bg-blue-600 rounded-full shadow-lg mb-2">
                    <IconCalculator className="w-8 h-8 text-white" />
                  </div>
                  <h1 className="text-3xl font-bold text-slate-900">2025 ç¨…å‹™è©¦ç®—</h1>
                </header>

                <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                  
                  {/* å·¦å´ï¼šè¼¸å…¥å€ */}
                  <div className="lg:col-span-2 space-y-6">
                    
                    {/* 1. æ”¶å…¥è³‡æ–™ */}
                    <section className="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
                      <div className="bg-slate-100 px-6 py-4 border-b border-slate-200 flex items-center gap-2">
                        <IconDollarSign className="w-5 h-5 text-blue-600" />
                        <h2 className="font-semibold text-lg">å¹´åº¦æ”¶å…¥è³‡æ–™</h2>
                      </div>
                      <div className="p-6 grid gap-6 sm:grid-cols-2">
                        <div>
                          <label className="block text-sm font-medium text-slate-700 mb-1">æœ¬äººè–ªè³‡æ‰€å¾—</label>
                          <div className="relative">
                            <input
                              type="number"
                              inputMode="numeric"
                              pattern="[0-9]*"
                              value={inputs.salary}
                              onChange={(e) => handleInputChange('salary', e.target.value)}
                              className="w-full p-3 pl-8 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all text-lg"
                            />
                            <span className="absolute left-3 top-3.5 text-slate-400">$</span>
                          </div>
                        </div>
                        
                        {inputs.isMarried && (
                          <div>
                            <label className="block text-sm font-medium text-slate-700 mb-1">é…å¶è–ªè³‡æ‰€å¾—</label>
                            <div className="relative">
                              <input
                                type="number"
                                inputMode="numeric"
                                pattern="[0-9]*"
                                value={inputs.spouseIncome}
                                onChange={(e) => handleInputChange('spouseIncome', e.target.value)}
                                className="w-full p-3 pl-8 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all text-lg"
                              />
                              <span className="absolute left-3 top-3.5 text-slate-400">$</span>
                            </div>
                          </div>
                        )}

                        <div className="sm:col-span-2">
                          <label className="block text-sm font-medium text-slate-700 mb-1">å…¶ä»–æ‰€å¾—</label>
                          <div className="relative">
                            <input
                              type="number"
                              inputMode="numeric"
                              pattern="[0-9]*"
                              value={inputs.otherIncome}
                              onChange={(e) => handleInputChange('otherIncome', e.target.value)}
                              className="w-full p-3 pl-8 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all text-lg"
                            />
                            <span className="absolute left-3 top-3.5 text-slate-400">$</span>
                          </div>
                        </div>
                      </div>
                    </section>

                    {/* 2. å®¶åº­èˆ‡æ‰¶é¤Š */}
                    <section className="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
                      <div className="bg-slate-100 px-6 py-4 border-b border-slate-200 flex items-center gap-2">
                        <IconUsers className="w-5 h-5 text-blue-600" />
                        <h2 className="font-semibold text-lg">å®¶åº­ç‹€æ³èˆ‡æ‰¶é¤Š</h2>
                      </div>
                      <div className="p-6 space-y-6">
                        <div className="flex items-center gap-4">
                          <span className="text-sm font-medium text-slate-700">å©šå§»ï¼š</span>
                          <div className="flex bg-slate-100 p-1 rounded-lg">
                            <button
                              onClick={() => handleInputChange('isMarried', false)}
                              className={`px-4 py-2 rounded-md text-sm font-medium transition-all ${!inputs.isMarried ? 'bg-white shadow text-blue-600' : 'text-slate-500 hover:text-slate-700'}`}
                            >
                              å–®èº«
                            </button>
                            <button
                              onClick={() => handleInputChange('isMarried', true)}
                              className={`px-4 py-2 rounded-md text-sm font-medium transition-all ${inputs.isMarried ? 'bg-white shadow text-blue-600' : 'text-slate-500 hover:text-slate-700'}`}
                            >
                              å·²å©š
                            </button>
                          </div>
                        </div>

                        <div className="grid grid-cols-1 sm:grid-cols-3 gap-4">
                          <div>
                            <label className="block text-sm font-medium text-slate-700 mb-1">æ‰¶é¤Š (70æ­²ä»¥ä¸‹)</label>
                            <div className="flex items-center">
                              <IconUser className="w-4 h-4 text-slate-400 mr-2" />
                              <input
                                type="number"
                                inputMode="numeric"
                                min="0"
                                value={inputs.dependentsUnder70}
                                onChange={(e) => handleInputChange('dependentsUnder70', e.target.value)}
                                className="w-full p-2 border border-slate-300 rounded-lg focus:ring-blue-500 text-lg"
                              />
                            </div>
                          </div>
                          <div>
                            <label className="block text-sm font-medium text-slate-700 mb-1">æ‰¶é¤Š (70æ­²ä»¥ä¸Š)</label>
                            <div className="flex items-center">
                              <IconUser className="w-4 h-4 text-slate-400 mr-2" />
                              <input
                                type="number"
                                inputMode="numeric"
                                min="0"
                                value={inputs.dependentsOver70}
                                onChange={(e) => handleInputChange('dependentsOver70', e.target.value)}
                                className="w-full p-2 border border-slate-300 rounded-lg focus:ring-blue-500 text-lg"
                              />
                            </div>
                          </div>
                          <div>
                            <label className="block text-sm font-medium text-slate-700 mb-1">6æ­²ä»¥ä¸‹å­å¥³</label>
                            <div className="flex items-center">
                              <IconBaby className="w-4 h-4 text-slate-400 mr-2" />
                              <input
                                type="number"
                                inputMode="numeric"
                                min="0"
                                value={inputs.childrenUnder6}
                                onChange={(e) => handleInputChange('childrenUnder6', e.target.value)}
                                className="w-full p-2 border border-slate-300 rounded-lg focus:ring-blue-500 text-lg"
                              />
                            </div>
                          </div>
                        </div>
                      </div>
                    </section>

                    {/* 3. æ‰£é™¤é¡é¸æ“‡ */}
                    <section className="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
                      <div className="bg-slate-100 px-6 py-4 border-b border-slate-200 flex items-center gap-2">
                        <IconFileText className="w-5 h-5 text-blue-600" />
                        <h2 className="font-semibold text-lg">æ‰£é™¤é¡è¨­å®š</h2>
                      </div>
                      <div className="p-6">
                        <div className="flex flex-wrap gap-4 mb-4">
                          <label className="flex items-center space-x-2 cursor-pointer">
                            <input
                              type="radio"
                              name="deductionMode"
                              checked={inputs.deductionMode === 'auto'}
                              onChange={() => handleInputChange('deductionMode', 'auto')}
                              className="text-blue-600 focus:ring-blue-500"
                            />
                            <span>è‡ªå‹•æœ€ä½³åŒ–</span>
                          </label>
                          <label className="flex items-center space-x-2 cursor-pointer">
                            <input
                              type="radio"
                              name="deductionMode"
                              checked={inputs.deductionMode === 'standard'}
                              onChange={() => handleInputChange('deductionMode', 'standard')}
                              className="text-blue-600 focus:ring-blue-500"
                            />
                            <span>æ¨™æº–</span>
                          </label>
                          <label className="flex items-center space-x-2 cursor-pointer">
                            <input
                              type="radio"
                              name="deductionMode"
                              checked={inputs.deductionMode === 'itemized'}
                              onChange={() => handleInputChange('deductionMode', 'itemized')}
                              className="text-blue-600 focus:ring-blue-500"
                            />
                            <span>åˆ—èˆ‰</span>
                          </label>
                        </div>

                        <div className={`transition-all duration-300 ${inputs.deductionMode === 'standard' ? 'opacity-50 pointer-events-none' : 'opacity-100'}`}>
                           <label className="block text-sm font-medium text-slate-700 mb-1">
                             åˆ—èˆ‰æ‰£é™¤é¡ç¸½è¨ˆ
                           </label>
                           <div className="relative">
                            <input
                              type="number"
                              inputMode="numeric"
                              value={inputs.itemizedAmount}
                              onChange={(e) => handleInputChange('itemizedAmount', e.target.value)}
                              disabled={inputs.deductionMode === 'standard'}
                              className="w-full p-3 pl-8 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all text-lg"
                            />
                            <span className="absolute left-3 top-3.5 text-slate-400">$</span>
                          </div>
                        </div>
                      </div>
                    </section>

                  </div>

                  {/* å³å´ï¼šçµæœå€ (Sticky) */}
                  <div className="lg:col-span-1">
                    <div className="sticky top-6 space-y-4">
                      
                      <div className="bg-gradient-to-br from-blue-900 to-blue-700 rounded-2xl shadow-lg text-white p-6 relative overflow-hidden">
                        <div className="absolute top-0 right-0 p-4 opacity-10">
                          <IconCalculator className="w-32 h-32" />
                        </div>
                        
                        <h3 className="text-blue-100 text-sm font-medium uppercase tracking-wider mb-1">é ä¼°æ‡‰ç´ç¨…é¡</h3>
                        <div className="text-4xl font-bold mb-4 tracking-tight">
                          {formatCurrency(results.taxPayable)}
                        </div>
                        
                        <div className="space-y-2 text-sm border-t border-blue-500/30 pt-4">
                          <div className="flex justify-between items-center">
                            <span className="text-blue-200">æ·¨é¡</span>
                            <span className="font-mono font-bold">{formatCurrency(results.netIncome)}</span>
                          </div>
                          <div className="flex justify-between items-center">
                            <span className="text-blue-200">ç¨…ç‡</span>
                            <span className="bg-blue-500/40 px-2 py-0.5 rounded text-white font-bold">{results.taxRate}%</span>
                          </div>
                        </div>
                      </div>

                      {/* ç´šè·è¦–è¦ºåŒ– */}
                      <div className="bg-white rounded-2xl shadow-sm border border-slate-200 p-6">
                        <div className="flex items-center gap-2 mb-4">
                          <IconCheckCircle className="w-5 h-5 text-green-500" />
                          <h3 className="font-bold text-slate-800">è½é»åˆ†æ</h3>
                        </div>
                        
                        <div className="relative pt-2 pb-6">
                          <div className="h-3 bg-slate-100 rounded-full overflow-hidden flex">
                            <div className={`h-full bg-green-400 transition-all duration-500`} style={{ width: results.taxRate >= 5 ? '20%' : '0%' }}></div>
                            <div className={`h-full bg-blue-400 transition-all duration-500`} style={{ width: results.taxRate >= 12 ? '20%' : '0%' }}></div>
                            <div className={`h-full bg-indigo-400 transition-all duration-500`} style={{ width: results.taxRate >= 20 ? '20%' : '0%' }}></div>
                            <div className={`h-full bg-purple-400 transition-all duration-500`} style={{ width: results.taxRate >= 30 ? '20%' : '0%' }}></div>
                            <div className={`h-full bg-pink-400 transition-all duration-500`} style={{ width: results.taxRate >= 40 ? '20%' : '0%' }}></div>
                          </div>
                          <div className="flex justify-between text-[10px] text-slate-400 mt-2 font-mono">
                            <span>5%</span>
                            <span>12%</span>
                            <span>20%</span>
                            <span>30%</span>
                            <span>40%</span>
                          </div>
                        </div>
                      </div>

                      {/* è©³ç´°ç®—å¼æŒ‰éˆ• */}
                      <button
                        onClick={() => setShowDetails(!showDetails)}
                        className="w-full bg-white border border-slate-300 hover:bg-slate-50 text-slate-700 py-3 rounded-xl flex items-center justify-center gap-2 transition-all"
                      >
                        {showDetails ? <IconChevronUp className="w-4 h-4" /> : <IconChevronDown className="w-4 h-4" />}
                        {showDetails ? "éš±è—æ˜ç´°" : "æŸ¥çœ‹æ˜ç´°"}
                      </button>

                      {/* è©³ç´°ç®—å¼å…§å®¹ */}
                      {showDetails && (
                        <div className="bg-slate-50 rounded-2xl p-4 text-sm space-y-3 border border-slate-200 animate-fadeIn">
                          <div className="flex justify-between">
                            <span>(+) ç¸½é¡</span>
                            <span>{formatCurrency(results.totalIncome)}</span>
                          </div>
                          <div className="flex justify-between text-red-500">
                            <span>(-) å…ç¨…é¡</span>
                            <span>-{formatCurrency(results.totalExemption)}</span>
                          </div>
                          <div className="flex justify-between text-red-500">
                            <span>(-) {results.deductionTypeUsed.substring(0,2)}æ‰£é™¤</span>
                            <span>-{formatCurrency(results.finalDeduction)}</span>
                          </div>
                          <div className="flex justify-between text-red-500">
                            <span>(-) è–ªè³‡æ‰£é™¤</span>
                            <span>-{formatCurrency(results.salaryDeduction)}</span>
                          </div>
                          {results.preschoolDeduction > 0 && (
                            <div className="flex justify-between text-red-500">
                              <span>(-) å¹¼å…’æ‰£é™¤</span>
                              <span>-{formatCurrency(results.preschoolDeduction)}</span>
                            </div>
                          )}
                          <div className="border-t border-slate-300 my-2 pt-2 flex justify-between font-bold">
                            <span>(=) æ·¨é¡</span>
                            <span>{formatCurrency(results.netIncome)}</span>
                          </div>
                          <div className="flex justify-between text-slate-500 text-xs">
                            <span>Ã— ç¨…ç‡ {results.taxRate}%</span>
                            <span>{formatCurrency(results.netIncome * (results.taxRate / 100))}</span>
                          </div>
                          <div className="flex justify-between text-slate-500 text-xs">
                            <span>- ç´¯é€²å·®é¡</span>
                            <span>-{formatCurrency(results.progressiveDifference)}</span>
                          </div>
                          <div className="border-t border-slate-300 my-2 pt-2 flex justify-between font-bold text-blue-700">
                            <span>(=) æ‡‰ç´ç¨…é¡</span>
                            <span>{formatCurrency(results.taxPayable)}</span>
                          </div>
                        </div>
                      )}

                    </div>
                  </div>
                </div>
              </div>
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<TaxCalculator />);
    </script>
</body>
</html>
